<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQLå¿«é€Ÿç”Ÿæˆå·¥å…·ï¼ˆé€‚é…MySQL/Oracle/äººå¤§é‡‘ä»“/è¾¾æ¢¦/ç¥é€š/é«˜æ–¯ï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft Yahei", sans-serif;
        }
        .container {
            max-width: 1000px;
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
            text-align: center;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }
        select, input, textarea {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
        }
        textarea {
            min-height: 80px;
            resize: vertical;
        }
        .field-group {
            display: flex;
            gap: 10px;
            margin-bottom: 8px;
        }
        .field-group input {
            width: 48%;
        }
        .btn {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
        }
        .btn:hover {
            background-color: #0056b3;
        }
        .sql-result {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
            font-family: "Consolas", monospace;
            font-size: 14px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .tips {
            margin-top: 10px;
            font-size: 12px;
            color: #666;
            line-height: 1.8;
        }
        .schema-input {
            margin-top: 8px;
            display: none;
        }
        .schema-input input {
            width: 100%;
            padding: 6px 8px;
            font-size: 13px;
            border: 1px solid #eee;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">SQLå¿«é€Ÿç”Ÿæˆå·¥å…·ï¼ˆMySQL/Oracle/äººå¤§é‡‘ä»“/è¾¾æ¢¦/ç¥é€š/é«˜æ–¯ï¼‰</div>

        <!-- æ•°æ®åº“ç±»å‹é€‰æ‹©ï¼ˆæ ¸å¿ƒæ–°å¢ï¼‰ -->
        <div class="form-group">
            <label for="dbType">ç›®æ ‡æ•°æ®åº“ç±»å‹</label>
            <select id="dbType">
                <option value="mysql">MySQL</option>
                <option value="oracle">Oracle</option>
                <option value="kingbase" selected>äººå¤§é‡‘ä»“ï¼ˆKingbaseï¼‰</option>
                <option value="dm">è¾¾æ¢¦ï¼ˆDMï¼‰</option>
                <option value="oscar">ç¥é€šï¼ˆOSCARï¼‰</option>
                <option value="gauss">é«˜æ–¯ï¼ˆGaussDBï¼‰</option>
            </select>
        </div>

        <!-- æ¨¡å¼/æ•°æ®åº“åè¾“å…¥ï¼ˆä¸åŒæ•°æ®åº“è‡ªåŠ¨æ˜¾ç¤º/éšè—ï¼‰ -->
        <div class="form-group schema-input" id="schemaArea">
            <label id="schemaLabel">æ¨¡å¼/æ•°æ®åº“å</label>
            <input type="text" id="schemaName" placeholder="è¯·è¾“å…¥æ¨¡å¼/æ•°æ®åº“åï¼ˆç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤ï¼‰">
        </div>

        <!-- æ“ä½œç±»å‹é€‰æ‹© -->
        <div class="form-group">
            <label for="sqlType">SQLæ“ä½œç±»å‹</label>
            <select id="sqlType">
                <option value="select">æŸ¥è¯¢ï¼ˆSELECTï¼‰</option>
                <option value="insert">æ–°å¢ï¼ˆINSERTï¼‰</option>
                <option value="update">ä¿®æ”¹ï¼ˆUPDATEï¼‰</option>
                <option value="delete">åˆ é™¤ï¼ˆDELETEï¼‰</option>
            </select>
        </div>

        <!-- è¡¨åè¾“å…¥ -->
        <div class="form-group">
            <label for="tableName">è¡¨åï¼ˆä¾‹ï¼šCOM_RECEIVE/empï¼‰</label>
            <input type="text" id="tableName" placeholder="è¯·è¾“å…¥è¡¨åï¼Œå¦‚ï¼šCOM_RECEIVE æˆ– emp">
        </div>

        <!-- å­—æ®µ/å€¼åŒºåŸŸï¼ˆæ ¹æ®æ“ä½œç±»å‹åŠ¨æ€æ˜¾ç¤ºï¼‰ -->
        <div class="form-group" id="fieldValueArea">
            <label id="fieldValueLabel">æŸ¥è¯¢å­—æ®µï¼ˆå¤šä¸ªå­—æ®µç”¨é€—å·åˆ†éš”ï¼Œ*ä»£è¡¨æ‰€æœ‰ï¼‰</label>
            <textarea id="fieldValue" placeholder="ä¾‹ï¼šARCHIVE_USER,ID æˆ– *"></textarea>
        </div>

        <!-- æ¡ä»¶è¾“å…¥ -->
        <div class="form-group" id="conditionArea">
            <label for="condition">æ¡ä»¶ï¼ˆWHEREå­å¥ï¼Œæ— éœ€å†™WHEREï¼Œä¾‹ï¼šARCHIVE_USER = 200ï¼‰</label>
            <input type="text" id="condition" placeholder="æ— æ¡ä»¶åˆ™ç•™ç©ºï¼Œä¾‹ï¼šARCHIVE_USER = 200 æˆ– ID > 100 AND NAME = 'æµ‹è¯•'">
        </div>

        <!-- æŒ‰é’®åŒºåŸŸ -->
        <div>
            <button class="btn" onclick="generateSQL()">ç”ŸæˆSQL</button>
            <button class="btn" onclick="clearAll()">æ¸…ç©ºå†…å®¹</button>
            <button class="btn" onclick="copySQL()">å¤åˆ¶SQL</button> <!-- æ–°å¢å¤åˆ¶åŠŸèƒ½ -->
        </div>

        <!-- SQLç»“æœå±•ç¤º -->
        <div class="sql-result" id="sqlResult">
            ç”Ÿæˆçš„SQLå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...
        </div>

        <!-- æç¤ºä¿¡æ¯ï¼ˆé€‚é…ä¸åŒæ•°æ®åº“ï¼‰ -->
        <div class="tips">
            ğŸ”” å„æ•°æ®åº“è¯­æ³•æç¤ºï¼š<br>
            1. é€šç”¨è§„åˆ™ï¼š<br>
            - æ–°å¢ï¼ˆINSERTï¼‰ï¼šå­—æ®µ1,å­—æ®µ2|å€¼1,å€¼2ï¼ˆç«–çº¿åˆ†éš”ï¼‰ï¼Œä¾‹ï¼šARCHIVE_USER,NAME|100,'æµ‹è¯•'ï¼›<br>
            - ä¿®æ”¹ï¼ˆUPDATEï¼‰ï¼šå­—æ®µ1=å€¼1,å­—æ®µ2=å€¼2ï¼Œä¾‹ï¼šARCHIVE_USER=NULL,NAME='æµ‹è¯•'ï¼›<br>
            - åˆ é™¤ï¼ˆDELETEï¼‰ï¼šæ— éœ€å¡«å†™å­—æ®µï¼Œä»…éœ€æ¡ä»¶ï¼›<br>
            2. ä¸“å±è§„åˆ™ï¼š<br>
            - MySQLï¼šæ ‡è¯†ç¬¦ç”¨åå¼•å·`ï¼Œæ¨¡å¼ä¸ºæ•°æ®åº“åï¼Œç©ºå€¼ç”¨NULLï¼›<br>
            - Oracleï¼šæ ‡è¯†ç¬¦ç”¨åŒå¼•å·ï¼Œæ¨¡å¼ä¸ºç”¨æˆ·/è¡¨ç©ºé—´ï¼Œå­—ç¬¦ä¸²æ‹¼æ¥ç”¨||ï¼Œç©ºå€¼ç”¨NULLï¼›<br>
            - äººå¤§é‡‘ä»“/è¾¾æ¢¦/é«˜æ–¯/ç¥é€šï¼šæ ‡è¯†ç¬¦ç”¨åŒå¼•å·ï¼Œæ¨¡å¼ä¸ºPUBLICï¼ˆé»˜è®¤ï¼‰ï¼Œå…¼å®¹PostgreSQLè¯­æ³•ï¼›<br>
            3. æ¨¡å¼/æ•°æ®åº“åç•™ç©ºæ—¶ï¼šMySQLç”¨å½“å‰åº“ï¼ŒOracleç”¨å½“å‰ç”¨æˆ·ï¼Œäººå¤§é‡‘ä»“é»˜è®¤PUBLICã€‚
        </div>
    </div>

    <script>
        // æ•°æ®åº“è¯­æ³•è§„åˆ™é…ç½®ï¼ˆæ ¸å¿ƒæ–°å¢ï¼šä¸åŒæ•°æ®åº“çš„è¯­æ³•å·®å¼‚ï¼‰
        const dbConfig = {
            mysql: {
                quote: '`', // æ ‡è¯†ç¬¦å¼•å·ï¼šåå¼•å·
                schemaLabel: 'æ•°æ®åº“åï¼ˆMySQLï¼‰',
                schemaDefault: '',
                needSchema: true
            },
            oracle: {
                quote: '"', // æ ‡è¯†ç¬¦å¼•å·ï¼šåŒå¼•å·
                schemaLabel: 'æ¨¡å¼/ç”¨æˆ·ï¼ˆOracleï¼Œä¾‹ï¼šSCOTTï¼‰',
                schemaDefault: '',
                needSchema: true
            },
            kingbase: {
                quote: '"', // æ ‡è¯†ç¬¦å¼•å·ï¼šåŒå¼•å·
                schemaLabel: 'æ¨¡å¼ï¼ˆäººå¤§é‡‘ä»“ï¼Œé»˜è®¤ï¼šPUBLICï¼‰',
                schemaDefault: 'PUBLIC',
                needSchema: true
            },
            dm: {
                quote: '"', // æ ‡è¯†ç¬¦å¼•å·ï¼šåŒå¼•å·
                schemaLabel: 'æ¨¡å¼ï¼ˆè¾¾æ¢¦ï¼Œé»˜è®¤ï¼šSYSDBAï¼‰',
                schemaDefault: 'SYSDBA',
                needSchema: true
            },
            oscar: {
                quote: '"', // æ ‡è¯†ç¬¦å¼•å·ï¼šåŒå¼•å·
                schemaLabel: 'æ¨¡å¼ï¼ˆç¥é€šï¼Œé»˜è®¤ï¼šPUBLICï¼‰',
                schemaDefault: 'PUBLIC',
                needSchema: true
            },
            gauss: {
                quote: '"', // æ ‡è¯†ç¬¦å¼•å·ï¼šåŒå¼•å·
                schemaLabel: 'æ¨¡å¼ï¼ˆé«˜æ–¯ï¼Œé»˜è®¤ï¼šPUBLICï¼‰',
                schemaDefault: 'PUBLIC',
                needSchema: true
            }
        };

        // åˆ‡æ¢æ•°æ®åº“ç±»å‹ï¼šæ˜¾ç¤º/éšè—æ¨¡å¼è¾“å…¥æ¡†ï¼Œæ›´æ–°æç¤º
        document.getElementById('dbType').addEventListener('change', function() {
            const dbType = this.value;
            const schemaArea = document.getElementById('schemaArea');
            const schemaLabel = document.getElementById('schemaLabel');
            
            // æ˜¾ç¤ºæ¨¡å¼è¾“å…¥æ¡†ï¼ˆæ‰€æœ‰æ•°æ®åº“éƒ½æ”¯æŒï¼Œä»…è°ƒæ•´æç¤ºï¼‰
            schemaArea.style.display = 'block';
            schemaLabel.innerText = dbConfig[dbType].schemaLabel;
            document.getElementById('schemaName').placeholder = `ç•™ç©ºä½¿ç”¨é»˜è®¤ï¼ˆ${dbConfig[dbType].schemaDefault}ï¼‰`;
            
            // åŒæ­¥æ›´æ–°æ“ä½œç±»å‹çš„æç¤ºï¼ˆåŸæœ‰é€»è¾‘ä¿ç•™ï¼‰
            updateFieldValueLabel(document.getElementById('sqlType').value);
        });

        // åˆ‡æ¢æ“ä½œç±»å‹ï¼šæ›´æ–°å­—æ®µ/å€¼è¾“å…¥æ¡†æç¤ºï¼ˆåŸæœ‰é€»è¾‘ä¼˜åŒ–ï¼‰
        document.getElementById('sqlType').addEventListener('change', function() {
            updateFieldValueLabel(this.value);
        });

        // åˆå§‹åŒ–ï¼šæ˜¾ç¤ºé»˜è®¤æ•°æ®åº“ï¼ˆäººå¤§é‡‘ä»“ï¼‰çš„æ¨¡å¼è¾“å…¥æ¡†
        window.onload = function() {
            const defaultDb = document.getElementById('dbType').value;
            document.getElementById('schemaArea').style.display = 'block';
            document.getElementById('schemaLabel').innerText = dbConfig[defaultDb].schemaLabel;
            document.getElementById('schemaName').placeholder = `ç•™ç©ºä½¿ç”¨é»˜è®¤ï¼ˆ${dbConfig[defaultDb].schemaDefault}ï¼‰`;
            updateFieldValueLabel('select');
        };

        // æ›´æ–°å­—æ®µ/å€¼æ ‡ç­¾çš„é€šç”¨å‡½æ•°
        function updateFieldValueLabel(sqlType) {
            const label = document.getElementById('fieldValueLabel');
            const fieldValue = document.getElementById('fieldValue');
            
            switch(sqlType) {
                case 'select':
                    label.innerText = 'æŸ¥è¯¢å­—æ®µï¼ˆå¤šä¸ªå­—æ®µç”¨é€—å·åˆ†éš”ï¼Œ*ä»£è¡¨æ‰€æœ‰ï¼‰';
                    fieldValue.placeholder = 'ä¾‹ï¼šARCHIVE_USER,ID æˆ– *';
                    document.getElementById('conditionArea').style.display = 'block';
                    break;
                case 'insert':
                    label.innerText = 'å­—æ®µå’Œå€¼ï¼ˆç«–çº¿åˆ†éš”ï¼Œä¾‹ï¼šå­—æ®µ1,å­—æ®µ2|å€¼1,å€¼2ï¼‰';
                    fieldValue.placeholder = 'ä¾‹ï¼šARCHIVE_USER,NAME|100,\'æµ‹è¯•\'';
                    document.getElementById('conditionArea').style.display = 'none';
                    break;
                case 'update':
                    label.innerText = 'ä¿®æ”¹çš„å­—æ®µå’Œå€¼ï¼ˆä¾‹ï¼šå­—æ®µ1=å€¼1,å­—æ®µ2=å€¼2ï¼‰';
                    fieldValue.placeholder = 'ä¾‹ï¼šARCHIVE_USER=NULL,NAME=\'æµ‹è¯•\'';
                    document.getElementById('conditionArea').style.display = 'block';
                    break;
                case 'delete':
                    label.innerText = 'åˆ é™¤æ“ä½œæ— éœ€å¡«å†™å­—æ®µï¼ˆç•™ç©ºå³å¯ï¼‰';
                    fieldValue.placeholder = 'ç•™ç©º';
                    document.getElementById('conditionArea').style.display = 'block';
                    break;
            }
        }

        // ç»™æ ‡è¯†ç¬¦åŠ å¼•å·ï¼ˆé€‚é…ä¸åŒæ•°æ®åº“ï¼‰
        function addQuote(str, dbType) {
            if (!str || str === '*') return str;
            const quote = dbConfig[dbType].quote;
            // å¤„ç†å¤šä¸ªå­—æ®µçš„æƒ…å†µ
            return str.split(',').map(item => {
                item = item.trim();
                // è·³è¿‡å·²ç»åŠ äº†å¼•å·çš„æƒ…å†µï¼Œé¿å…é‡å¤
                if (item.startsWith(quote) && item.endsWith(quote)) return item;
                return `${quote}${item}${quote}`;
            }).join(',');
        }

        // å¤„ç†è¡¨åï¼ˆæ‹¼æ¥æ¨¡å¼/æ•°æ®åº“åï¼‰
        function getFullTableName(tableName, schemaName, dbType) {
            const quote = dbConfig[dbType].quote;
            // è¡¨ååŠ å¼•å·
            const quotedTable = `${quote}${tableName}${quote}`;
            // æ¨¡å¼åå¤„ç†ï¼šç•™ç©ºåˆ™ç”¨é»˜è®¤ï¼Œå¦åˆ™åŠ å¼•å·
            let schema = schemaName.trim() || dbConfig[dbType].schemaDefault;
            if (!schema) return quotedTable;
            const quotedSchema = `${quote}${schema}${quote}`;
            return `${quotedSchema}.${quotedTable}`;
        }

        // å¤„ç†æ¡ä»¶ä¸­çš„å­—æ®µå¼•å·
        function handleConditionQuote(condition, dbType) {
            if (!condition) return '';
            const quote = dbConfig[dbType].quote;
            // åŒ¹é…æ¡ä»¶ä¸­çš„å­—æ®µåï¼ˆç®€å•é€‚é…ï¼šå­—æ¯æ•°å­—ä¸‹åˆ’çº¿ + è¿ç®—ç¬¦ï¼‰
            return condition.replace(/([a-zA-Z0-9_]+)(\s*=|<|>|>=|<=|!=|LIKE|IN)/g, `${quote}$1${quote}$2`);
        }

        // ç”ŸæˆSQLæ ¸å¿ƒå‡½æ•°ï¼ˆé€‚é…å¤šæ•°æ®åº“ï¼‰
        function generateSQL() {
            // è·å–è¾“å…¥å€¼
            const dbType = document.getElementById('dbType').value;
            const sqlType = document.getElementById('sqlType').value;
            let tableName = document.getElementById('tableName').value.trim();
            const fieldValue = document.getElementById('fieldValue').value.trim();
            const condition = document.getElementById('condition').value.trim();
            const schemaName = document.getElementById('schemaName').value.trim();

            // åŸºç¡€æ ¡éªŒ
            if (!tableName) {
                alert('è¯·è¾“å…¥è¡¨åï¼');
                return;
            }

            // å¤„ç†è¡¨åï¼ˆæ‹¼æ¥æ¨¡å¼+åŠ å¼•å·ï¼‰
            const fullTableName = getFullTableName(tableName, schemaName, dbType);

            let sql = '';
            switch(sqlType) {
                // æŸ¥è¯¢ï¼ˆSELECTï¼‰
                case 'select':
                    let selectFields = fieldValue || '*';
                    // å­—æ®µåŠ å¼•å·
                    selectFields = addQuote(selectFields, dbType);
                    sql = `SELECT ${selectFields} FROM ${fullTableName}`;
                    // å¤„ç†æ¡ä»¶
                    if (condition) {
                        const whereCondition = handleConditionQuote(condition, dbType);
                        sql += ` WHERE ${whereCondition}`;
                    }
                    break;

                // æ–°å¢ï¼ˆINSERTï¼‰
                case 'insert':
                    if (!fieldValue || !fieldValue.includes('|')) {
                        alert('æ–°å¢æ“ä½œéœ€æŒ‰ã€Œå­—æ®µ1,å­—æ®µ2|å€¼1,å€¼2ã€æ ¼å¼è¾“å…¥ï¼');
                        return;
                    }
                    const [fields, values] = fieldValue.split('|').map(item => item.trim());
                    if (!fields || !values) {
                        alert('å­—æ®µæˆ–å€¼ä¸èƒ½ä¸ºç©ºï¼');
                        return;
                    }
                    // å­—æ®µåŠ å¼•å·
                    const insertFields = addQuote(fields, dbType);
                    sql = `INSERT INTO ${fullTableName} (${insertFields}) VALUES (${values})`;
                    break;

                // ä¿®æ”¹ï¼ˆUPDATEï¼‰
                case 'update':
                    if (!fieldValue) {
                        alert('ä¿®æ”¹æ“ä½œéœ€å¡«å†™å­—æ®µå’Œå€¼ï¼');
                        return;
                    }
                    // æ‹†åˆ†ä¿®æ”¹é¡¹ï¼Œç»™å­—æ®µåŠ å¼•å·
                    const updateItems = fieldValue.split(',').map(item => {
                        const [f, v] = item.split('=').map(i => i.trim());
                        const quotedField = addQuote(f, dbType);
                        return `${quotedField}=${v}`;
                    });
                    sql = `UPDATE ${fullTableName} SET ${updateItems.join(',')}`;
                    // å¤„ç†æ¡ä»¶
                    if (condition) {
                        const whereCondition = handleConditionQuote(condition, dbType);
                        sql += ` WHERE ${whereCondition}`;
                    }
                    break;

                // åˆ é™¤ï¼ˆDELETEï¼‰
                case 'delete':
                    sql = `DELETE FROM ${fullTableName}`;
                    // å¤„ç†æ¡ä»¶
                    if (condition) {
                        const whereCondition = handleConditionQuote(condition, dbType);
                        sql += ` WHERE ${whereCondition}`;
                    }
                    break;
            }

            // æ˜¾ç¤ºç”Ÿæˆçš„SQLï¼ˆåŠ ç»“æŸåˆ†å·ï¼Œé€‚é…ä¸åŒæ•°æ®åº“ï¼‰
            const finalSQL = sql + (dbType === 'oracle' ? ';' : ';'); // Oracleä¹Ÿæ”¯æŒåˆ†å·
            document.getElementById('sqlResult').innerText = finalSQL;
        }

        // æ¸…ç©ºæ‰€æœ‰è¾“å…¥
        function clearAll() {
            document.getElementById('tableName').value = '';
            document.getElementById('fieldValue').value = '';
            document.getElementById('condition').value = '';
            document.getElementById('schemaName').value = '';
            document.getElementById('sqlResult').innerText = 'ç”Ÿæˆçš„SQLå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...';
        }

        // æ–°å¢ï¼šå¤åˆ¶SQLåˆ°å‰ªè´´æ¿
        function copySQL() {
            const sqlText = document.getElementById('sqlResult').innerText;
            if (sqlText === 'ç”Ÿæˆçš„SQLå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...') {
                alert('æš‚æ— å¯å¤åˆ¶çš„SQLï¼');
                return;
            }
            navigator.clipboard.writeText(sqlText).then(() => {
                alert('SQLå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            }).catch(() => {
                // é™çº§æ–¹æ¡ˆï¼šæ‰‹åŠ¨é€‰ä¸­å¤åˆ¶
                const textArea = document.createElement('textarea');
                textArea.value = sqlText;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('SQLå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            });
        }
    </script>
</body>
</html>